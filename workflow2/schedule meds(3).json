{
  "name": "schedule meds",
  "nodes": [
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "SAFE_ID_1",
              "leftValue": "=\n{{ $json.message.text }}",
              "rightValue": "done",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -432,
        -368
      ],
      "id": "SAFE_ID_2",
      "name": "If"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "SAFE_GOOGLE_SHEET_ID",
          "mode": "list",
          "cachedResultName": "patients_meds",
          "cachedResultUrl": "SAFE_URL_GOOGLE_SHEET"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Sheet1",
          "cachedResultUrl": "SAFE_URL_SHEET_GID"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Done": "undone",
            "Date": "={{ $json.currentDate }}"
          },
          "matchingColumns": [
            "Date"
          ],
          "schema": [
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Age",
              "displayName": "Age",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "name_meds",
              "displayName": "name_meds",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "dose",
              "displayName": "dose",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "instrustions ",
              "displayName": "instrustions ",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Date",
              "displayName": "Date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Done",
              "displayName": "Done",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -224,
        -160
      ],
      "id": "SAFE_ID_3",
      "name": "Update row in sheet1",
      "executeOnce": false,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "SAFE_GOOGLE_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "content": "## SCHEDULE\n3 triggers to run 3 time a day ",
        "height": 608,
        "width": 374,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2032,
        -624
      ],
      "typeVersion": 1,
      "id": "SAFE_ID_4",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "## Data  \nmanaging and filtering  data  ",
        "height": 608,
        "width": 256,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1664,
        -624
      ],
      "typeVersion": 1,
      "id": "SAFE_ID_5",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "## TELEGRAM\nSend a message, extract date, Sheet",
        "height": 608,
        "width": 662,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1408,
        -624
      ],
      "typeVersion": 1,
      "id": "SAFE_ID_6",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "content": "## Reading the message \ngetting the nurse's reply\nwaiting for  5min for the nurse's reply",
        "height": 608,
        "width": 272,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -752,
        -624
      ],
      "id": "SAFE_ID_7",
      "name": "Sticky Note6"
    },
    {
      "parameters": {
        "jsCode": "const elders = [...]"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1792,
        -352
      ],
      "id": "SAFE_ID_8",
      "name": "Code in JavaScript3"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "SAFE_ID_9",
              "leftValue": "={{ $json.Instructions }}",
              "rightValue": "breakfast",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2.2,
      "position": [
        -1600,
        -496
      ],
      "id": "SAFE_ID_10",
      "name": "Filter"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "SAFE_ID_11",
              "leftValue": "={{ $json.Instructions }}",
              "rightValue": "lunch",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2.2,
      "position": [
        -1600,
        -352
      ],
      "id": "SAFE_ID_12",
      "name": "Filter1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "SAFE_ID_13",
              "leftValue": "={{ $json.Instructions }}",
              "rightValue": "bed",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2.2,
      "position": [
        -1600,
        -192
      ],
      "id": "SAFE_ID_14",
      "name": "Filter2"
    },
    {
      "parameters": {
        "chatId": "SAFE_CHAT_ID",
        "text": "=Patient: {{ $json.Name }} \nAge: {{ $json.Age }} \nMedication: {{ $json.name_meds }}\nDose:{{ $json.dose }}\nInstructions:{{ $json['instrustions '] }}\nPlease reply with ‘Done’ once the task is completed.",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -688,
        -352
      ],
      "id": "SAFE_ID_15",
      "name": "Send a text message",
      "webhookId": "SAFE_WEBHOOK_ID_1",
      "credentials": {
        "telegramApi": {
          "id": "SAFE_TELEGRAM_CREDENTIAL",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "updates": [
          "message"
        ],
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1.2,
      "position": [
        -688,
        -144
      ],
      "id": "SAFE_ID_16",
      "name": "Telegram Trigger",
      "webhookId": "SAFE_WEBHOOK_ID_2",
      "credentials": {
        "telegramApi": {
          "id": "SAFE_TELEGRAM_CREDENTIAL",
          "name": "Telegram account"
        }
      }
    }
  ]
}
